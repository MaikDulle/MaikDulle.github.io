<!-- Cookie Consent + GA4 -->
<script>
(function() {
  var consent = localStorage.getItem('cookie_consent');
  
  // Load GA4 only if consented
  function loadGA4() {
    var s = document.createElement('script');
    s.src = 'https://www.googletagmanager.com/gtag/js?id=G-NP9BDJ3H8V';
    s.async = true;
    document.head.appendChild(s);
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-NP9BDJ3H8V');
    (function heartbeat(){gtag("event","heartbeat");setTimeout(heartbeat,5*60*1000)}());
  }
  
  if (consent === 'accepted') { loadGA4(); return; }
  if (consent === 'rejected') return;
  
  // Show banner
  document.addEventListener('DOMContentLoaded', function() {
    var banner = document.createElement('div');
    banner.id = 'cookie-banner';
    banner.innerHTML = '<div style="position:fixed;bottom:0;left:0;right:0;background:#222;color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;z-index:9999;font-size:14px;">' +
      '<span>This site uses cookies for analytics. </span>' +
      '<div><button id="cb-accept" style="background:#4CAF50;color:#fff;border:none;padding:8px 16px;margin-right:8px;cursor:pointer;border-radius:4px;">Accept</button>' +
      '<button id="cb-reject" style="background:#666;color:#fff;border:none;padding:8px 16px;cursor:pointer;border-radius:4px;">Reject</button></div></div>';
    document.body.appendChild(banner);
    
    document.getElementById('cb-accept').onclick = function() {
      localStorage.setItem('cookie_consent', 'accepted');
      banner.remove();
      loadGA4();
    };
    document.getElementById('cb-reject').onclick = function() {
      localStorage.setItem('cookie_consent', 'rejected');
      banner.remove();
    };
  });
})();
</script>
